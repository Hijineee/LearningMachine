<?xml version="1.0" encoding="UTF-8" ?> <!-- 맵퍼파일 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="Community">

  	<select id="totalCount"  parameterType="String" resultType="integer">
  		SELECT count(*)
  		from ${name}
  	</select>
  	
  	<select id="qnaList" parameterType="map" resultType="map">
		SELECT q.*, v.c_name,v.lqar_title,v.lqar_content, if(q.lqa_confirm=0,"답변미완료","답변완료")AS confirm 
		FROM lecture_qna_view v RIGHT JOIN lecture_qna q
		ON v.lqa_no = q.lqa_no

  		<if test="c_name != null">
  		where c_name = #{c_name}
  		</if>
  	
  		ORDER BY lqa_no
  		<if test="page != null">
  		limit #{page.startPage},#{page.lastPage}
  		</if>
  	</select>
  	
  	<select id="communitySearch" parameterType="String" resultType="LectureDTO">
  		select *, if(q.lqa_confirm=0,"답변미완료","답변완료")AS confirm
  		FROM lecture_qna_view v RIGHT JOIN lecture_qna q
		ON v.lqa_no = q.lqa_no
		<if test="lqa_title != null">
  		where q.lqa_title LIKE '%' #{lqa_title } '%'
  		</if>
  	</select>	
  
  </mapper>